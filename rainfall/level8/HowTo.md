## HowTo
```
su level8
5684af5cb4c8679958be4abe6373147ab52d95768e047820bf382e44fa8d8fb9
```

### Инструменты:
- Ida Pro + hex rays
- peda (gdb + patterns)
- ltrace

### Анализ и ход решения
1. Используем Ida Pro для создания Си-псевдокода, - в бинарнике исполняется много циклов, на асм понять их довольно сложно (см. псевдокод в файле в репозитории).

2. Обнаруживаем, что мы имеем несколько команд, запускающих исполнение разных циклов.
3. Внутри циклов изменяются значения указателей, хранящихся в переменных.
```
"auth " - whitespace is IMPORTANT!
"service"
"reset"
"login"
```

3. Команда `login` запускает исполнение цикла, который проверяет смещение указателя `auth` и, если указанная область не пуста, запускает `system('/bin/sh')`
```
0x080486e7 <+387>: mov    eax,DWORD PTR [eax+0x20] (32d)
```

4. Далее экспериментируем с командами:
- `"auth "` - задает значение 1-й переменной и при повторном введение растит указатель на `16`
- `"service"` - задает значение 2-й переменной и при повторном введении растит указатель на `16`
- `"reset"` - работает с переменной, вывод которой мы не видим в печати и которая не нашу задачу влияние не имеет
- `"login"` - тригерит запуск проверки адресов и исполнение

5. Нам нужно добиться того, чтобы память со смещением `32 (0x20)` от `auth` (1-я переменная) была не пуста.
Введя:
```
"auth "
"service"
```
Видим, что расстояние между указателями - `16`.
Растим переменную service на `16`, до `32`.

**NB:** Мы можем вырастить значения `auth` и `service` до произвольных размеров, главное, соблюсти расстояние между ними в `32`


### Решение
```
> ./level8
"auth " - whitespace is IMPORTANT!
"service"
"service"
"login"
$ whoami
level9
cat /home/user/level9/.pass
c542e581c5ba5162a85f767996e3247ed619ef6c6f7b76a59435545dc6259f8a
```